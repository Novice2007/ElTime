{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome</title>
    <link rel="icon" href="{% static '/images/favicon.ico' %}">

    <link rel="stylesheet" href="{% static '/css/main.css' %}">
    <link rel="stylesheet" href="{% static '/css/elements.css' %}">
    <link rel="stylesheet" href="{% static '/css/welcome.css' %}">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300..700&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>
<body>
    <header id="header">
        <h1>ElTime</h1>
        <div class="flex-row">
            <button type="button" class="secondary" onclick="handleAuthorizationClick()">Войти</button>
            <button type="button" class="secondary" onclick="handleRegistrationClick()">Зарегистрироваться</button>
        </div>
    </header>
    <div class="flex-column">
        <div class="fixed-center flex-column flex-centered" id="about">
            <h1>Добро пожаловать в ElTime</h1>
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Sequi eos exercitationem enim possimus distinctio sint ducimus similique, reprehenderit doloremque, ullam consequuntur dolore ipsum ab fugit iste id officia tenetur! Sed!</p>
        </div>
        
        <div class="fixed-center flex-column action-form" id="registration">
            <form action="/actions/registration/" method="post">
                {% csrf_token %}
                <div class="input">
                    <label for="login">Логин</label>
                    <input type="text" name="login" id="registration-login">
                </div>
                <div class="input">
                    <label for="email">Почта</label>
                    <input type="text" name="email" id="email">
                </div>
                <div class="input">
                    <label for="registration-password">Пароль</label>
                    <input type="password" name="password" id="registration-password">
                </div>
                <div class="input">
                    <label for="password-repeat">Повторите пароль</label>
                    <input type="password" name="password-repeat" id="password_repeat">
                </div>

                <div class="flex-row action-buttons">
                    <button class="primary" type="button" onclick="handleCloseActionForm()">Назад</button>
                    <button class="secondary" type="submit">Зарегистрироваться</button>
                </div>
            </form>
        </div>
        <div class="fixed-center flex-column action-form" id="authorization">
            <form action="/actions/authorization/" method="post">
                {% csrf_token %}

                <!-- <p class="error-message"></p> -->

                <div class="input">
                    <label for="login">Логин</label>
                    <input type="text" name="login" id="auth-login">
                </div>

                <div class="input">
                    <label for="auth-password">Пароль</label>
                    <input type="password" name="password" id="auth-password">
                </div>

                <div id="form-actions">
                    <!-- <button type="button" onclick="handleToggleHiddenBlock()">Забыли пароль?</button> -->

                    <button type="button">Забыли пароль?</button>

                    <!-- <div id="hidden">
                        <div class="input">
                            <label for="recovery-email">Почта, к которой привязан аккаунт</label>
                            <input type="email" name="recovery-email" id="recovery-email">
                        </div>
                    </div> -->
                </div>

                <div class="flex-row action-buttons">
                    <button class="primary" type="button" onclick="handleCloseActionForm()">Назад</button>
                    <button class="secondary" type="submit">Войти</button>
                </div>
            </form>
        </div>
    </div>

    <script src="{% static '/js/welcome.js' %}"></script>
    {% if "username-exists" in request.session.registration_error %}
    
    <script>

        const registrationErrorParagraph = document.createElement("p");
        registrationErrorParagraph.classList.add("error-message");
        registrationErrorParagraph.textContent = "Логин занят ;(";

        document
            .getElementById("registration")
            .getElementsByTagName("form")[0]
            .prepend(registrationErrorParagraph);

        handleRegistrationClick();

    </script>
    {% endif %}
    {% if request.session.errors %}
    <script
        id=""
        data-errors="{{request.session.errors}}"
    >
        const errors = JSON.parse(
            document.currentScript.getAttribute("data-errors")
                .replace(/'/g, '"')
        );

        if (errors.authorization) {
            handleAuthorizationClick();
        } else if (errors.registration) {
            handleRegistrationClick();
        }
    </script>
    {% endif %}
</body>
</html>
